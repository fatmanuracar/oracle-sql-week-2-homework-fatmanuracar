/*
alter session set "_ORACLE_SCRIPT"=true; 
CREATE USER WHITE_GOODS IDENTIFIED BY white123;
GRANT CREATE SESSION TO WHITE_GOODS;
GRANT CONNECT, RESOURCE, DBA TO WHITE_GOODS;
*/
CREATE TABLE CLIENTS
(
    client_id       NUMBER
        GENERATED BY DEFAULT AS IDENTITY START WITH 1000
    PRIMARY KEY,
    first_name      VARCHAR2(50) NOT NULL,
    last_name       VARCHAR2(50) NOT NULL,
    telephone       VARCHAR2(20) NOT NULL,
    e_mail          VARCHAR2(75),
    address         VARCHAR2(250) NOT NULL,
    date_           DATE NOT NULL,
    product_model   VARCHAR2(25) NOT NULL, -- FK
    constraýnt      fk_client_product
FOREIGN KEY (product_id) REFERENCES product(product_id)
            ON DELETE CASCADE
);
    
    
CREATE TABLE PRODUCT
(
     product_id number
                GENERATED BY DEFAULT AS IDENTITY START WITH 1
                PRIMARY KEY,
    product_model varchar2(25) NOT NULL,
    category_id number NOT NULL, 
    production_date date NOT NULL,
    production_site varchar2(50) NOT NULL,
        CONSTRAINT fk_product_category 
        FOREIGN KEY( category_id )
        REFERENCES category_( category_id )
    ON DELETE CASCADE
);  


CREATE TABLE category_
( category_id NUMBER
    GENERATED BY DEFAULT AS IDENTITY START WITH 1
PRIMARY KEY,
    category_name varchar2(30) NOT NULL,
    segment_type varchar2(10) NOT NULL,
    campaign varchar2(50) NOT NULL,
    feedback_ varchar2(250) NOT NULL );
    

/*
INSERT SCRIPTLERÝ TABLO1:CUSTOMERS ;

Insert into CUSTOMERS (CUSTOMER_ID,FIRST_NAME,LAST_NAME,TELEPHONE,E_MAIL,ADDRESS,PRODUCT_ID,DATE_) 
values (1,'AYCAN','SARI','05332394516',null,'ISTANBUL','WT7WH460TR','02.05.2019');

Insert into CUSTOMERS (CUSTOMER_ID,FIRST_NAME,LAST_NAME,TELEPHONE,E_MAIL,ADDRESS,PRODUCT_ID,DATE_) 
values (2,'ALÝ','GENC','05527456321','ali.genc@gmail.com','BURSA','KG86NAWF0N','28.11.2018');

Insert into CUSTOMERS (CUSTOMER_ID,FIRST_NAME,LAST_NAME,TELEPHONE,E_MAIL,ADDRESS,PRODUCT_ID,DATE_) 
values (10,'BURAK','SESLÝ','05456458972',null,'ANKARA','HB514FBH0T','08.08.2019');

Insert into CUSTOMERS (CUSTOMER_ID,FIRST_NAME,LAST_NAME,TELEPHONE,E_MAIL,ADDRESS,PRODUCT_ID,DATE_) 
values (105,'SEMA','SERCAN','05398521256','sema@gmail.com','KOCAELÝ','WM14XEH0TR','19.12.2017');

Insert into CUSTOMERS (CUSTOMER_ID,FIRST_NAME,LAST_NAME,TELEPHONE,E_MAIL,ADDRESS,PRODUCT_ID,DATE_) 
values (501,'BUSE','ALLI','05362354897',null,'BALIKESIR','HB557JYS0T','24.10.2019');

Insert into CUSTOMERS (CUSTOMER_ID,FIRST_NAME,LAST_NAME,TELEPHONE,E_MAIL,ADDRESS,PRODUCT_ID,DATE_) 
values (66,'SEMA','SERCAN','05431076063','sema@gmail.com','ISTANBUL','SN235I00JT','14.04.2018');

Insert into CUSTOMERS (CUSTOMER_ID,FIRST_NAME,LAST_NAME,TELEPHONE,E_MAIL,ADDRESS,PRODUCT_ID,DATE_) 
values (78,'SEMA','SERCAN','05398521256',null,'KOCAELÝ','SN278I16TT','28.12.2018');
*/



/*
INSERT SCRIPTLERÝ TABLO2:PRODUCT ;

 INSERT INTO PRODUCT (PRODUCT_ID, PRODUCT_MODEL, CATEGORY_ID, PRODUCTION_DATE, PRODUCTION_SITE) 
 VALUES (451,'HB514FBH0T',4,'15.02.2018','KOCAELÝ');
 
 INSERT INTO PRODUCT (PRODUCT_ID, PRODUCT_MODEL, CATEGORY_ID, PRODUCTION_DATE, PRODUCTION_SITE) 
 VALUES (457,'HB557JYS0T',4,'15.02.2018','KOCAELÝ');

INSERT INTO PRODUCT (PRODUCT_ID, PRODUCT_MODEL, CATEGORY_ID, PRODUCTION_DATE, PRODUCTION_SITE) 
VALUES (556,'KD76NAWF0N',2,'09.07.2018','ISTANBUL');

INSERT INTO PRODUCT (PRODUCT_ID, PRODUCT_MODEL, CATEGORY_ID, PRODUCTION_DATE, PRODUCTION_SITE) 
VALUES (559,'KG86NAWF0N',2,'09.07.2019','ISTANBUL');

INSERT INTO PRODUCT (PRODUCT_ID, PRODUCT_MODEL, CATEGORY_ID, PRODUCTION_DATE, PRODUCTION_SITE) 
VALUES (601,'SN234W00DT',3,'10.07.2020','TEKÝRDAÐ');

INSERT INTO PRODUCT (PRODUCT_ID, PRODUCT_MODEL, CATEGORY_ID, PRODUCTION_DATE, PRODUCTION_SITE) 
VALUES (602,'SN278I16TT',3,'20.07.2019','TEKÝRDAÐ');

INSERT INTO PRODUCT (PRODUCT_ID, PRODUCT_MODEL, CATEGORY_ID, PRODUCTION_DATE, PRODUCTION_SITE) 
VALUES (805,'WT7WH460TR',1,'25.07.2019','KOCAELÝ');

INSERT INTO PRODUCT (PRODUCT_ID, PRODUCT_MODEL, CATEGORY_ID, PRODUCTION_DATE, PRODUCTION_SITE) 
VALUES (800,'WG52A2X0TR',1,'25.07.2018','ÝSTANBUL');
*/


-- INSERT -> TABLO3: CATEGORY_ ÝÇÝN EXCELDEN IMPORT ALARAK YAPTIM.

--Synonym Scripti
create  synonym product_syn for product;

--View Scripti: Adreslere göre hangi segmentler satýlmýþ?
create view address_segment_relation as
(select address, segment_type from customers c 
inner join product p on p.product_id=c.product_id
inner join category_ ct on ct.category_id=p.category_id
where address='KOCAELÝ' and segment_type = 'ÝQ500');
